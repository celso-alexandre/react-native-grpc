# react-native-grpc

gRPC for react-native

## Note
This is a direct fork of [@Mitch528/rect-native-grpc](https://github.com/Mitch528/react-native-grpc), go an try out his work first, as it is more feature complete.
I'm not doing serious changes, don't 100% know what I'm doing either; I'm just trying to make the typescript wrapper work in my new expo app.

## Installation

```sh
npm install @celsoalexandre/react-native-grpc
```

## Usage

```shellscript
# Generate your protobuf-typescript files from source .proto
PROTO_SRC_DIR="subdir/dot_proto_dir"
OUT_DIR="out/proto_ts_dir"
PLUGIN="node_modules/.bin/protoc-gen-ts_proto"
protoc \
  --plugin="$PLUGIN" \
  -I="$PROTO_SRC_DIR" \
  --ts_proto_out="$OUT_DIR" \
  --ts_proto_opt=grpcMetadata=true,outputClientImpl=true \
  --ts_proto_opt=forceLong=long,esModuleInterop=true \
  "$PROTO_SRC_DIR"/*.proto
```

```ts
// This example uses protoc (cli binary) + ts-proto (pnpm)
import { GrpcClient } from '@celsoalexandre/react-native-grpc';
import { NativeModules } from 'react-native';
import { AuthServiceClientImpl } from '../../proto/auth'; // generated by protoc

// The native function (IOS/Android) that actually make the gRPC calls.
// The library makes it available under the name `Grpc`.
const Grpc = NativeModules.Grpc;

if (!Grpc || typeof Grpc.setHost !== 'function') {
  throw new Error('[Grpc] GrpcClient is not properly initialized. Use custom dev client via `expo run:android|ios`.');
}

Grpc.setHost('localhost:8443');

const client = new GrpcClient(Grpc);

export const authClient = new AuthServiceClientImpl({
  request: async (service, method, data) => {
    const path = `/${service}/${method}`;
    
    const { responseData } = await client.unaryCall(path, data);
    
    // responseData is a Uint8Array. Your generated serviceClient should be able to decode it to json when returned here
    return responseData;
  },
});

```

See `examples` project for more advanced usage.

## Limitations

This library currently only supports unary ~~and server-side streaming~~ type RPC calls. PRs are welcome.

## Contributing

See the [contributing guide](CONTRIBUTING.md) to learn how to contribute to the repository and the development workflow.

## License

MIT
